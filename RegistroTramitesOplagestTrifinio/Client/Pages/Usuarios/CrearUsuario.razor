@page "/usuarios/crear"
@inject NavigationManager Navigation
@inject IPeticionesHttp Http
@inject IMostrarMensaje Mensaje

<h3 class="display-4">Crear usuario</h3>
<FormularioUsuarios OnValidSubmit="Crear" Usuario="Usuario" Fuente="Nuevo"/>

@code {
    public UsuarioFormularioDTO Usuario { get; set; } = new();

    public async Task Crear()
    {
        var respuesta = await Http.Post<UsuarioFormularioDTO>("api/cuentas", Usuario);

        if (respuesta.Error)
        {
            await Mensaje.Error(await respuesta.ObtenerMensaje());
        }
        else
        {
            Navigation.NavigateTo("/usuarios");
        }
    }
}
